---
layout: post
title:  "[프로젝트] Medium 클론 백엔드를 만들어보자 -2장"
tags: project
excerpt: "Medium 클론 백엔드를 설계부터 배포까지 기록하는 시리즈"
comments: true
---

**목차**
1. [Medium 클론 백엔드를 만들어보자 -1장]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-1장/)
2. Medium 클론 백엔드를 만들어보자 -2장
3. [Medium 클론 백엔드를 만들어보자 -3장]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-3장/)
4. [Medium 클론 백엔드를 만들어보자 -4장]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-4장/)
5. [Medium 클론 백엔드를 만들어보자 -5장]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-5장/)
6. [Medium 클론 백엔드를 만들어보자 -6장]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-6장/)
7. [Medium 클론 백엔드를 만들어보자 -7장]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-7장/)
8. [Medium 클론 백엔드를 만들어보자 -8장]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-8장/)

# 이전 포스트에서 . . .
- 왜 다시 이 프로젝트를 하는지
- 어떤 언어를 사용할 것인지

# 이 포스트는 . . .
- 어떤 프레임워크/툴들을 사용 할 것인지에 대해 알아보자.

# 백엔드 설계

일단 저번 포스트에서도 언급했듯이 언어는 Go로 정해졌다. 이유는 내가 Go 언어를 공부해보고 싶기 때문이다. 

그리고 디자인 방식도 REST에 최대한 준수하는 API를 만들어 보겠다고 했다. 

그러면 현재 언어와 설계 방식은 정해져있다. 그러면 이에 맞는 **프레임워크**와 **개발 방식** 그리고 개발 방식에 따른 **테스트 라이브러리**을 정해보자.

# 프레임워크

Go에서 REST한 API를 만들때 쓰는 프레임워크 중 대략 7가지를 보고 하나를 정하려고 한다.

7개의 프레임워크는 이 [영문 포스트](https://nordicapis.com/7-frameworks-to-build-a-rest-api-in-go/)에 있다

1. Revel - "out of the box" 프레임워크
2. Gin - "lean", 미니멀리스틱한 프레임워크 
3. Martini - Gin의 베이스가 되는 라이브러리
4. Web.go - 트리 라우팅을 사용하는 미니멀한 라이브러리
5. Gorilla - package관리가 쉬운 프레임워크
6. Goji - 정말 최소한의 기능만 구현된 프레임워크
7. Beego - Revel 같은 out of the box 프레임워크

일단 Revel, Beego 같은 경우는 너무 많은 것들이 이미 구현이 돼있어서 배우는게 없을 것 같아서 제외시키겠다. 

Web.go, Goji 같은 경우는 너무 미니멀한 것들이라 제외시키겠다. 너무 미니멀하면 구현을 해야하는 것들이 너무 많아져서 시간이 또 오래걸린다.

Gorilla 같은 경우는 package 단위로 더하고 빼고 할 수 있어서 좋지만, 설정이 까다롭다는 점에서 Go를 처음 접하는 내가 효율적으로 사용할 수 있을까라는 의문이 있을뿐더러 package 설정에 쏟는 시간을 차라리 테스트나 자동화에 쏟는게 더 바람직하다고 생각하니까 빼도록 하겠다. 

그러면 Gin과 Martini가 남게 되는데, 사용사례도 Gin이 더 많은 것 같고 Gin이 Martini보다 40배 빠르다고 하니까 이번 프로젝트는 Gin으로 백엔드를 개발 할 것이다.

# 개발 방식

개발 프레임워크를 정했으니 어떤 식으로 개발을 할지 정해보자.

기본적으로 개발은 그냥 해도 된다. 하지만 그냥 개발하면 서비스도 그냥 나온다. 

> 쓰레기 input -> Computer -> 쓰레기 output

즉, 제대로 된 코드를 짜려면 개발 방식도 고려를 해야한다. 하지만 내가 대학교에서 배운, 아니 배우지도 않았다, 듣기만한 TDD (Test driven development)뿐 이다.

3년 가량 학교에서 개발을 배웠지만, 실제로 TDD를 적용한건 2주 미디엄클론을 했을 때 뿐이다.

어떤 개발 방식이 있는지 알아보자

1. TDD - 최소한의 개발 -> 테스트 케이스를 먼저 작성 -> 기능구현을 하면서 테스트를 통과하는지 검증
2. BDD - TDD와 비슷하게, 최소한의 개발 -> 유저 시나리오에 맞는 테스트 케이스 작성 -> 기능구현을 하면서 테스트를 통과하는지 검증
3. DDD - 도메인을 중점으로 개발을 함. Business logic에 맞게 변수/클래스 명을 작성하는 등, 비개발자도 개발자와 코드를 보면서 협업할 수 있도록 하는 것이 포인트. 
4. ATDD - TDD의 업그레이드 버전, 기존 TDD는 코드가 잘 작동하는냐가 중점이라면 ATDD는 Acceptance 기준이 있어서 이 코드가 왜 필요한가? 도 따지게 되는 것
5. FDD - 기능 중점 개발

여기서 알아야 할 것은 개발 방식은 **하나**를 정해서 하는 것이 아니라 **여러 개**가 얽혀있는 방식이다. 가령 BDD 같은 경우 TDD 와 DDD를 섞은 방식이라고 볼 수 있다. 

아무튼, 나는 BDD 방식으로 접근을 할 것이다. 

TDD 방식으로 테스트케이스 -> 개발 -> 검증 으로 코드의 안정성을 유지하고 DDD 방식으로 비개발자가 테스트 코드를 보아도 의도된 행동양식을 통과한다는 것을 알 수 있게끔 API endpoint나 변수/클래스 같은 것들을 알기 쉽게 작성할 계획이다.  

# 테스트 라이브러리

자, 이제 테스트 라이브러리만 정하면 된다. 

Go는 기본 Testing 라이브러리가 잘 되어 있어서 굳이 다른 라이브러리를 사용할 필요가 없지만, 개발자 편의를 위해 만들어 놓은 제 3 라이브러리를 사용 안 할 이유 또한 없다.

BDD에 걸맞는 라이브러리가 어떤 것들이 있는지 알아보자.

출처는 이 [영문 포스트](https://bmuschko.com/blog/go-testing-frameworks/)다

포스트에는 여러 가지 테스트 라이브러리가 있는데 BDD에 특화된 라이브러리를 나열하면:

1. Ginkgo and Gomega
2. Goblin
3. GoConvey
4. 기본 Go Testing 라이브러리

가 있다.

일단 Ginkgo 와 Gomega 조합은 사용자도 많고 BDD에 최적화 되어 있고 기능들도 많다. 하지만 기능이 많다는 것은 내가 직접 구현해야 할 것들이 줄어들어서 배움의 장이 좁아진 다는 것이기 때문에 패스하도록 하겠다.

GoConvey 같은 경우 UI로 볼 수 있는 서버가 띄워지고 쓰기 편해보이지만 개인적으로 web에 띄워지는 UI로 테스트 코드 결과를 보는 것보다 terminal에 바로 보여지는 것을 선호하기 때문에 패스하겠다.

기본 Go testing 라이브러리는 BDD 로 테스트 케이스를 작성하면 코드 자체가 상당히 지저분해 질 것 같아서 패스하도록 하겠다.

결론은 Ginkgo보다 기능들이 더 적게 구현되어 있지만 있을 건 다 있는 Goblin으로 하곘다.

# 마무리

정리 하자면 이번 포스트에서 정한 것은 
1. 개발 프레임워크 - Gin
2. 개발 방식 - BDD
3. 테스트 라이브러리 - Goblin

이 되겠다. 

[다음 포스트]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-3장/)에서는 프로젝트 관리는 무엇으로 할 것인지와 어떤 CI/CD 툴을 사용할 것 인지에 대해 알아보자.