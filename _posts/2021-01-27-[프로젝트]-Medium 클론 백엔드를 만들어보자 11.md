---
layout: post
title:  "[프로젝트] Medium 클론 백엔드를 만들어보자 -11"
tags: project
excerpt: "Medium 클론 백엔드를 설계부터 배포까지 기록하는 시리즈"
comments: true
---

**목차**
1. [Medium 클론 백엔드를 만들어보자 -1]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-1/)
2. [Medium 클론 백엔드를 만들어보자 -2]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-2/)
3. [Medium 클론 백엔드를 만들어보자 -3]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-3/)
4. [Medium 클론 백엔드를 만들어보자 -4]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-4/)
5. [Medium 클론 백엔드를 만들어보자 -5]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-5/)
6. [Medium 클론 백엔드를 만들어보자 -6]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-6/)
7. [Medium 클론 백엔드를 만들어보자 -7]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-7/)
8. [Medium 클론 백엔드를 만들어보자 -8]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-8/)
9. [Medium 클론 백엔드를 만들어보자 -9]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-9/)
10. [Medium 클론 백엔드를 만들어보자 -10]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-10/)
11. Medium 클론 백엔드를 만들어보자 -11

# 이전 포스트에서 . . .
- 배포 과정을 자동화

# 이 포스트는 . . .
- 중간 점검

# 현재 진행 상황
한동안 글을 쓰지 않아서 중간 점검할 겸 작성하는 포스트다. 현재 TDD 방식으로 테스트케이스를 먼저 작성하고 로직 코드를 짜는 방식으로 프로젝트를 진행 중에 있다.

그 동안 구현한 것들을 나열하자면:
1. DB에 users 와 posts 테이블을 구현하고 실제로 데이터를 삽입/삭제/업데이트 할 수 있도록 한 것
2. `/users`, `/posts`, `/login`, `/logout` 등 api endpoint들을 하나씩 간단하게나마 테스트코드와 함께 구현 한 것
3. 리팩토링

# 처음 디자인과 바뀐 점
프로젝트를 진행하면서 처음 설계 미스로 수정해야 할 몇 가지 부분이 생겼다. 

**AWS RDS**

일단 AWS RDS가 월 750시간 인 줄 알았는데 프리티어 기간 (12개월) 전체 동안 750시간 인 것 같다. 아직 월 사용량이 안 찍혀서 잘 모르겠지만 문득 12개월에 750시간인 것 같아서 배포 할 때만 RDS 켜고 그 외에는 꺼 놓는 방식으로 프로젝트를 진행 중이다.

**Oauth2.0가 아닌 JWT를 이용한 유저 인증/인가**

Oauth2를 구현하려고 했는데 굳이 필요가 없다는 느낌을 받았다. Oauth2의 메리트는 제 3자의 유저 인증과 소셜 로그인이 가능하다는 것인데 현재 이 클론 프로젝트는 제 3자의 유저 인증과 소셜 로그인이 필요 없는 것 같아서 빼기로 결정했다.

이후 다른 인가 방식 중에 Bearer authentication을 JWT를 사용해 구현 하도록 했다. JWT를 전달하는 방식은 `httpOnly` cookie로 유저에게 전달한다. `httpOnly`로 토큰을 쿠키에 저장시켜서 전달하게 되면, 유저쪽에서 `Document.Cookie`로 쿠키에 저장된 토큰을 사용할 수 없다. 하지만 JWT는 기본적으로 해독이 가능하기 때문에 HTTPS가 필수적이다. 

현재는 HTTP 기반이지만 JWT를 사용해서 유저를 인증/인가 시키기로 결정했다. 이유는 토큰 방식 인증/인가를 써본 적이 없고 배우고 싶어서가 제일 큰 이유고 현재 API에 Oauth2는 필요 없다고 생각하기 때문이다. 

# 앞으로 해야 할 것들
아직 구현해야 할 것들은 많이 있다. 
1. JWT로 유저 인가/인증
2. `/posts`의 실질적인 데이터로 CRUD를 구현
3. 네거티브 테스트 케이스 작성
4. tag/author 기반 posts 찾기 등
5. 리팩토링

# 현재까지 느낀 점
처음 설계한 대로 RESTful API는 잘 만들고 있는 것 같다. TDD 방식도 잘 유지 중이다. 하지만 공부해야 할 것들이 더 있다는 것을 느꼈다.

기본적으로 부족하다고 느낀 것은 다음과 같다.

**DB 설계 능력 부족**. 

현재 users 와 posts 테이블이 있고 관계형 DB를 사용하고 있지만 두 테이블 사이 연관점을 잇는 방법을 모른다. Foreign Key를 사용하면 되는 것을 어렴풋이 알고만 있을뿐이다.

현재 서비스가 작아서 망정이지 만약 더 많은 테이블과 연관관계를 다뤄야하는 서비스를 만들어야 한다면 DB 공부는 필수라는 것을 알았다.

또한 DB 관련된 기본적인 부분이 부족하다. Indexing, transaction, pool, join, cartesian product 같이 다 한번 씩 들어는 보았지만 정확히는 모르는 상태다.

공부의 필요성을 느꼈다.

**비효율적인 개발 습관**

나의 개발 습관은 다음과 같다.
1. 아이디어를 일단 코드로 구현한다. 이때는 모든 코드가 한 파일에 있거나, 작은 부분적인 코드들은 중복이 되거나 하는 편이다
2. 기능 구현에 막히면 공식 문서/스택오버플로우 등을 참고한다
3. 이후 기능을 성공적으로 구현을 하면 구닥다리 코드를 리팩토링한다
4. 파일로 나누고 객체화를 하는 등 좀 더 관리가 용이하게 바꾼다

위의 과정을 계속 거치다 보니까 불필요하게 코드 파일이 커진다. 예를 들면 하나의 테스트 과정을 한 파일에 다 때려박아 넣어놓은 것도 있다.

개발 방식을 바꿔야한다는 느낌이 들었다. 하지만 이것은 곧 경험/지식과도 연관이 되는 것 같다. 디자인 패턴 등을 알아야 아이디어를 구현하는 단계에서 범용성있는 코드를 짤 수 있다는 것을 느꼈다.

**디자인 패턴의 부재**

백엔드의 디자인 방식이 RESTful인것은 좋지만 Creational, Structural, Behavioral 등 프로그래밍의 디자인 패턴을 몰라서 코드가 더 난잡해지고 있다는 느낌이 들었다.

디자인 패턴을 좀 공부를 해야지 될 것 같다.

결론적으로 기본을 좀 더 공부해야한다.

# 마무리 
정리를 하자면:
- 몇가지 변경사항이 있었지만 개발은 잘 하고 있는 중이다
- 기본적인 CS 지식이 부족하다는 것을 느꼈다

다음 포스트는 백엔드를 완료하고 후기 형식으로 작성할 것이다.