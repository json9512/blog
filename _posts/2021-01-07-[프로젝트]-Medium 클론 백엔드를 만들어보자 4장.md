---
layout: post
title:  "[프로젝트] Medium 클론 백엔드를 만들어보자 -4장"
tags: project
excerpt: "Medium 클론 백엔드를 설계부터 배포까지 기록하는 시리즈"
comments: true
---

**목차**
1. [Medium 클론 백엔드를 만들어보자 -1장]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-1장/)
2. [Medium 클론 백엔드를 만들어보자 -2장]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-2장/)
3. [Medium 클론 백엔드를 만들어보자 -3장]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-3장/)
4. Medium 클론 백엔드를 만들어보자 -4장
5. [Medium 클론 백엔드를 만들어보자 -5장]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-5장/)
6. [Medium 클론 백엔드를 만들어보자 -6장]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-6장/)

# 이전 포스트에서 . . .
- 어떤 CI/CD 툴을 사용할 지
- 어떤 프로젝트 관리 툴을 사용할 지

# 이 포스트는 . . .
- 앱 설계
- 어떤 데이터베이스를 사용할지

# 앱 설계

사실 이 "앱 설계"만 적어도 10 포스트는 넘게 작성 할 수 있다. 그만큼 고려해야하는 것이 많기 때문이다. 여태까지 해 왔던 것들도 나름 앱 설계에 들어간다고 볼 수 있다.

0년차 개발자로서 개발지식은 많지 않다.

하지만 새로운 앱을 만들 때 고려해야 하는 것들을 좀 나열해 본다면:

1. 앱은 웹을 위한 앱인지, 안드로이드/iOS를 위한 앱인지, 아니면 둘 다를 위한 앱인지
2. 설계 방식은 Monolithic 인지, SOA인지, MSA 인지
3. 유저 인증/인가는 어디서, 어떻게 할건지, 따로 서버를 둘 건지
4. Scale이 가능한 앱인지, 어느 부분에서 어떤 metric을 기준으로 Scale out할 건지
5. 백엔드는 stateful 한지 stateless한지
6. 저장소는 어떻게 운영할 건지, 캐시는 활용 할 것인지
7. 어떤 디자인 원칙을 준수할 것인지
8. 버전 관리는 어떻게 할 것인지
9. 테스트는 어떻게 할 것인지, 배포는 어떻게 할 것인지
10. load balancing은 어떻게 할 것인지
11. 분산된 아키텍쳐면 로그는 어떻게 관리할 것인지
12. 데이터베이스는 scale 할 것인지
13. 방화벽은 어디에 어떻게 적용이 될 것인지

등등 끝도 없다. 

이 것외에도 엄청 많겠지만 현재 나의 지식으로는 이정도 밖에 생각을 못하겠다. ㅠㅠ

0년차인데 이런 것들을 알아야 하나 싶겠지만, 세상이 새로운 개발자에게 요구하는 지식은 갈 수록 늘어날 수 밖에 없다. 없는 것은 몰라도 되지만 있는 것은 알아야 한다. 

아무튼, 이 프로젝트의 앱 설계를 위의 9번까지 기준으로 작성을 해보자면 :

1. 이 앱은 웹을 위한 것이다.
2. 설계 방식은 Monolithic 한 방식을 쓰겠다. 이유는 기능별로 서버를 나눌 필요가 없기 때문이다
3. 유저 인증/인가는 다른 포스트에서 다루도록 하겠다
4. scale은 가능하게끔 만들겠지만 scale 하지는 않을 것 같다
5. stateless한 서버를 만들겠다 RESTful 하기 위해
6. 캐시는 없고, 데이터베이스는 추후에 서술하겠다
7. 디자인 원칙은 백엔드는 REST에 최대한 준수한 HTTP API
8. 버전 관리는 gvm을 통해서 하겠다
9. 테스트는 전 포스트에서 언급한 것 처럼 BDD를 준수하며 테스트 케이스를 만들고 Github Actions로 자동화 시키겠다

자, high-level 이지만 대략적인 앱 설계는 끝났다. 

설계한 대로 코드를 짤 수 있도록 잘 기억하도록 하자.

# 데이터베이스

이제 데이터베이스를 정해보자. 

이것 또한 여러가지 방법이 있고 상황에 따라 적절한 데이터베이스를 정하는 것이 중요하다. 

일단 제일 큰 축인, 관계형을 쓸 것인지 NoSql을 쓸 것인지부터 정하도록 하겠다. 

저번 프로젝트에서는 관계형 데이터베이스인 Postgresql을 사용했다. 이번 프로젝트도 기능을 생각해 봤을 때 유저가 있고, 유저마다 포스트를 작성할 수 있고, 포스트에 좋아요를 표시할 수 있고, 코멘트 역시 달 수 있다는 점에서 관계형 RDBMS가 좋은 것 같다.

그러면 RDBMS 중에 사용 할 만한 툴을 찾아보자:

1. Postgresql
2. MySQL
3. SQLite

등이 있다. 

이번 프로젝트도 Postgresql을 사용하도록 하겠다. 이유는 현재 컴퓨터에 설치되어 있고 바로 구동 가능하기 때문이다. 

프로젝트의 목표는 새 언어를 배우고 백엔드를 설계/자동화 하는 것이기 때문에 새로운 데이터베이스를 설치하고 설정하는 것에 시간을 투자하는 것은 비효율적이라고 판단했기 때문이다. 

SQL은 하나만 쓸 줄 알면 나머지도 언어 자체는 똑같기 때문에 사용하는데 무리가 없다. 

# 마무리

정리를 하자면:

1. 앱 설계를 Monolithic, stateless, scale 가능하게 했고
2. 데이터베이스는 Postgresql이고 캐시는 없다.

[다음 포스트]({{site.baseurl}}/프로젝트-Medium-클론-백엔드를-만들어보자-5장/)에서는 백엔드 API를 endpoint들을 설계해보자

